{% extends "base.html" %}
{% from "macros.html" import icon, card, chart_container, page_header, stat_card %}

{% block title %}{{ page_title }} - {{ config.APP_NAME }}{% endblock %}

{% block page_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages.css') }}">
{% endblock %}

{% block content %}
<div class="page-container">
    {{ page_header("财务仪表盘", "", "layout-dashboard") }}
    
    <!-- 数据容器 -->
    <div id="dashboard-data" 
         data-balance="{{ template_data.balance }}"
         data-monthly-trends='{{ template_data.monthly_trends|tojson|safe }}'
         style="display: none;">
    </div>
    
    <div class="cards-grid cols-4">
        <!-- 账户余额卡片 -->
        {{ stat_card("wallet", "¥" + "%.2f"|format(template_data.balance or 0), "账户总余额", "success", "success") }}
    </div>
    
    <!-- 余额趋势图表卡片 -->
    <div class="col-12">
        {% call card("最近12个月余额趋势", "trending-up") %}
        <canvas id="balanceTrendChart" class="chart-canvas"></canvas>
        {% endcall %}
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}